<!DOCTYPE html>
<html>
    <head>
        <title>loadmapasyncHTML</title>
        <style type='text/css'>body{margin:0;padding:0;overflow:hidden;font-family:'Segoe UI',Helvetica,Arial,Sans-Serif}</style>
        <meta http-equiv='Content-Type' content='text/html; charset=utf-8'/>
        <script type='text/javascript' src='https://www.bing.com/api/maps/mapcontrol?key='></script>
        <script type='text/javascript'>
		
				var entities = [
					{ "name":"vincent","position":{"latitude":13.107673631379782,"longitude":80.29390144098141},"color":"orange","description":"programmer" },
					{ "name":"robert","position":{"latitude":13.092488900156042,"longitude":80.18744992959836},"color":"green","description":"analyst"}
				]
				
				
                var map;
			
/*https://www.bing.com/api/maps/sdkrelease/mapcontrol/isdk/pushpindragevents*/
				
                function loadMapScenario()
				{
                     var map = new Microsoft.Maps.Map(document.getElementById('myMap'), {
                    /* No need to set credentials if already passed in URL */
                    center: new Microsoft.Maps.Location(13.079454766739488, 80.27396726358273),
                    mapTypeId: Microsoft.Maps.MapTypeId.aerial,
                    zoom: 13
					});
					
				var pushpins=[];	
				var infoBoxes=[];
				
				 //Create an infobox at the center of the map but don't show it.
				infobox = new Microsoft.Maps.Infobox(map.getCenter(), {
					visible: false
				});

				//Assign the infobox to a map instance.
				infobox.setMap(map);

				var infoboxTemplate = '<div id="infoboxText" style="background-color:White; border-style:solid; border-width:medium; border-color:DarkOrange; min-height:100px; width: 240px;margin-top:140px;margin-left:-100px;">' +
									'<div id="infoboxTitle" style="">{title}</b>' +
									'<div id="infoboxDescription" style="">{description}</a></div>';
									
				

				for ( var i=0; i<entities.length ; i++)
				{
					pushpins[i] = createCirclePushpin(new Microsoft.Maps.Location(entities[i].position.latitude,entities[i].position.longitude), 25, 'rgba(255, 255, 255, 0.8)', entities[i].color, 2,'black',i,entities[i].name,entities[i].description);
					map.entities.push(pushpins[i]);
					
						pushpins[i].metadata = {
						title: entities[i].name,
						description: entities[i].description
					};
					/*
					infoBoxes[i] = new Microsoft.Maps.Infobox(new Microsoft.Maps.Location(entities[i].position.latitude,entities[i].position.longitude), { htmlContent: infoboxTemplate.replace('{title}', 'myTitle').replace('{description}', 'myDescription') });
					infoBoxes[i].setOptions({ visible: false });
					infoBoxes[i].setMap(map);*/
				
				Microsoft.Maps.Events.addHandler(pushpins[i], 'mouseover', showInfoBox);
				Microsoft.Maps.Events.addHandler(pushpins[i], 'mouseout', hideInfoBox);
				}
				
				function showInfoBox(e) {
					//Make sure the infobox has metadata to display.
					if (e.target.metadata) {
						//Set the infobox options with the metadata of the pushpin.
						infobox.setOptions({
							location: e.target.getLocation(),
							title: e.target.metadata.title,
							description: e.target.metadata.description,
							htmlContent: infoboxTemplate.replace('{title}',  e.target.metadata.title).replace('{description}', e.target.metadata.description),
							visible: true
						});
					}
				}
				function hideInfoBox(e) {
					//Make sure the infobox has metadata to display.
					if (e.target.metadata) {
						//Set the infobox options with the metadata of the pushpin.
						infobox.setOptions({
							visible: false
						});
					}
				}

				
                function createCirclePushpin(location, radius, fillColor, strokeColor, strokeWidth, textColor,id,name,description)
				{
                    if (strokeColor === void 0) { strokeColor = ""; }
                    if (strokeWidth === void 0) { strokeWidth = 0; }
                    //Create an SVG string of a circle with the specified radius and color.
                    var svg = "<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"" + 2 * radius + "\" height=\"" + 2 * radius + "\">\n        <circle cx=\"" + radius + "\" cy=\"" + radius + "\" r=\"" + (radius - strokeWidth) + "\" stroke=\"" + strokeColor + "\" stroke-width=\"" + strokeWidth + "\" fill=\"" + fillColor + "\"/><text x='50%' y='50%' text-anchor='middle' stroke='"+textColor+"' stroke-width='2px' dy='.3em'>"+id+"</text></svg> ";
                    //Create a pushpin from the SVG and anchor it to the center of the circle.
                    return new Microsoft.Maps.Pushpin(location, { icon: svg, anchor: new Microsoft.Maps.Point(radius, radius),					 title: name,
					subTitle: description, });
				}
	  
	  
			
	  
                }
                
			
            
        </script>
    </head>
    <body onload='loadMapScenario();'>
        <div id='printoutPanel'></div>
        
        <div id='myMap' style='width: 100vw; height: 100vh;'></div>
    </body>
</html>